{"version":3,"sources":["branch.js"],"names":["map","async","mostrarBranch","resultado","fetch","method","json","forEach","sucursal","id","location","branchName","email","name","lastName","sucursal_mostrar","document","querySelector","contenido","createElement","className","titulo","info","h1","textContent","appendChild","innerHTML","div_btn","form","action","btn","type","mapa","google","maps","Map","center","lat","lng","zoom","Marker","position","title","addEventListener","seleccionarBranch","isUser","userId","sessionStorage","getItem","token","header","Headers","append","headers","redirect","usuario","nombreUsuario","classList","remove","add","cambiarBtn","e","console","error","window","setItem","target","toggle"],"mappings":"AAAA,IAAIA,IAKJC,eAAeC,gBACX,IACI,MAAMC,QAAkBC,MAAM,kBAAkB,CAACC,OAAQ,QA4DzD,UA3DyBF,EAAUG,QACf,QAAEC,QAAQC,IAC1B,IAAIC,GAAEA,EAAEC,SAAEA,EAAQC,WAAEA,GAAgBH,GAChCI,MAAEA,EAAKC,KAAEA,EAAIC,SAAEA,GAAaN,EAAgB,MAChD,MAAMO,EAAmBC,SAASC,cAAc,aAC1CC,EAAYF,SAASG,cAAc,OACzCD,EAAUE,UAAY,qBACtB,MAAMC,EAASL,SAASG,cAAc,OACtCE,EAAOD,UAAY,SACnB,MAAME,EAAON,SAASG,cAAc,OACpCG,EAAKb,GAAK,OACVa,EAAKF,UAAY,OAGjB,MAAMG,EAAKP,SAASG,cAAc,MAClCI,EAAGC,YAAcb,EACjBU,EAAOI,YAAYF,GACnBL,EAAUO,YAAYJ,GAEtBC,EAAKI,UACL,sDACuCb,KAAQC,iDACzBF,qDACIF,6BAE1B,MAAMiB,EAAUX,SAASG,cAAc,OACvCQ,EAAQlB,GAAK,cACbkB,EAAQP,UAAY,0BACpB,MAAMQ,EAAOZ,SAASG,cAAc,QACpCS,EAAKC,OAAS,cACdD,EAAKvB,OAAS,MACd,MAAMyB,EAAMd,SAASG,cAAc,UACnCW,EAAIV,UAAY,iBAChBU,EAAIN,YAAc,cAClBM,EAAIC,KAAO,SACXD,EAAIrB,GAAK,qBACTqB,EAAIjB,KAAOJ,EAEXmB,EAAKH,YAAYK,GACjBH,EAAQF,YAAYG,GACpBN,EAAKG,YAAYE,GACjBT,EAAUO,YAAYH,GAGtB,MAAMU,EAAOhB,SAASG,cAAc,OACpCa,EAAKZ,UAAY,OACjBpB,IAAM,IAAIiC,OAAOC,KAAKC,IAAIH,EAAM,CAC5BI,OAAQ,CAACC,IAAK,kBAAmBC,KAAM,oBACvCC,KAAM,KAEG,IAAIN,OAAOC,KAAKM,OAAO,CAChCC,SAAU,CAACJ,IAAK,kBAAmBC,KAAM,oBACzCtC,IAAKA,IACT0C,MAAO/B,IAEPO,EAAUO,YAAYO,GACtBjB,EAAiBU,YAAYP,GAC7BY,EAAIa,iBAAiB,QAASC,qBAE/BC,SAAS,CACV,MAAMC,EAASC,eAAeC,QAAQ,UAChCC,EAAQF,eAAeC,QAAQ,SAC/BE,EAAS,IAAIC,QACnBD,EAAOE,OAAO,gBAAiB,UAAUH,GACzC,MAAMnB,EAAMd,SAASC,cAAc,gBAC7Bd,QAAkBC,MAAM,aAAa0C,EAAS,CAACzC,OAAQ,MAAOgD,QAASH,EAAQI,SAAU,WACzFC,QAAgBpD,EAAUG,QAC1BO,KAAEA,EAAIC,SAAEA,GAAayC,EACrBC,EAAgBxC,SAASC,cAAc,kBAC7Ca,EAAI2B,UAAUC,OAAO,yBACrB5B,EAAI2B,UAAUE,IAAI,sBAClBH,EAAchC,YAAc,GAAGX,KAAQC,IACvC8C,iBACK,CACL,MAAM9B,EAAMd,SAASC,cAAc,gBACnCa,EAAI2B,UAAUE,IAAI,yBAClB7B,EAAI2B,UAAUC,OAAO,uBAG3B,MAAMG,GACFC,QAAQC,MAAMF,IAItB,SAASjB,kBAAkBiB,GACzBG,OAAOjB,eAAekB,QAAQ,WAAWJ,EAAEK,OAAOrD,MAClDG,SAASN,SAAW,mCAGtB,SAASmC,SAEP,OAAoC,GAAjCE,eAAeC,QAAQ,OAO5B,SAASY,aACW5C,SAASC,cAAc,UAC/BwC,UAAUU,OAAO,WACRnD,SAASC,cAAc,WAC/BwC,UAAUU,OAAO,SA7G9BnD,SAAS2B,iBAAiB,oBAAoB,WAC1CzC","file":"branch.js","sourcesContent":["var map;\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    mostrarBranch();\r\n});\r\n\r\nasync function mostrarBranch(){\r\n    try{\r\n        const resultado = await fetch('/api/branch/all',{method: 'GET'});\r\n        const sucursales = await resultado.json();\r\n        sucursales[\"content\"].forEach(sucursal => {\r\n            let { id, location, branchName  } = sucursal;\r\n            let { email, name, lastName } = sucursal[\"owner\"];\r\n            const sucursal_mostrar = document.querySelector(\"#sucursal\");\r\n            const contenido = document.createElement(\"div\");\r\n            contenido.className = \"sucursal-contenido\";\r\n            const titulo = document.createElement(\"div\");\r\n            titulo.className = \"nombre\";\r\n            const info = document.createElement(\"div\");\r\n            info.id = \"info\";\r\n            info.className = \"info\";\r\n\r\n            // Titulo\r\n            const h1 = document.createElement(\"h1\");\r\n            h1.textContent = branchName;\r\n            titulo.appendChild(h1);\r\n            contenido.appendChild(titulo);\r\n            \r\n            info.innerHTML = \r\n            `\r\n                <p>Nombre de la encargada: <span>${name} ${lastName}</span></p>\r\n                <p>Email: <span>${email}</span></p>\r\n                <p>Direccion: <span>${location}</span></p>\r\n            `;\r\n            const div_btn = document.createElement(\"div\");\r\n            div_btn.id = \"seleccionar\";\r\n            div_btn.className = \"seleccionar-no-sucursal\";\r\n            const form = document.createElement(\"form\");\r\n            form.action = \"/app/client\";\r\n            form.method = \"GET\";\r\n            const btn = document.createElement(\"button\");\r\n            btn.className = \"btn-secundario\";\r\n            btn.textContent = \"Seleccionar\";\r\n            btn.type = \"button\";\r\n            btn.id = \"seleccion-sucursal\";\r\n            btn.name = id;\r\n\r\n            form.appendChild(btn);\r\n            div_btn.appendChild(form);\r\n            info.appendChild(div_btn);\r\n            contenido.appendChild(info);\r\n            \r\n            // Mapa\r\n            const mapa = document.createElement(\"div\");\r\n            mapa.className = \"mapa\";\r\n            map = new google.maps.Map(mapa, {\r\n                center: {lat: 21.14197073516805, lng: -100.31784830972968},\r\n                zoom: 15\r\n              });\r\n            var marker = new google.maps.Marker({\r\n                position: {lat: 21.14197073516805, lng: -100.31784830972968},\r\n                map: map,\r\n            title: branchName\r\n              });\r\n            contenido.appendChild(mapa);\r\n            sucursal_mostrar.appendChild(contenido);\r\n            btn.addEventListener(\"click\", seleccionarBranch)\r\n        });\r\n        if(isUser()){\r\n          const userId = sessionStorage.getItem(\"userId\");\r\n          const token = sessionStorage.getItem(\"token\");\r\n          const header = new Headers();\r\n          header.append(\"Authorization\", `Bearer ${token}`);\r\n          const btn = document.querySelector(\"#seleccionar\");\r\n          const resultado = await fetch(`/api/user/${userId}`,{method: 'GET', headers: header, redirect: \"follow\"});\r\n          const usuario = await resultado.json();\r\n          const { name, lastName } = usuario;\r\n          const nombreUsuario = document.querySelector(\"#nombreUsuario\");\r\n          btn.classList.remove(\"seleccion-no-sucursal\");\r\n          btn.classList.add(\"seleccion-sucursal\")\r\n          nombreUsuario.textContent = `${name} ${lastName}`;\r\n          cambiarBtn();\r\n        } else {\r\n          const btn = document.querySelector(\"#seleccionar\");\r\n          btn.classList.add(\"seleccion-no-sucursal\");\r\n          btn.classList.remove(\"seleccion-sucursal\")\r\n        }\r\n    }\r\n    catch(e){\r\n        console.error(e);\r\n    }\r\n}\r\n\r\nfunction seleccionarBranch(e) {\r\n  window.sessionStorage.setItem(\"branchId\",e.target.name);\r\n  document.location = \"http://localhost:5500/app/client\";\r\n}\r\n\r\nfunction isUser(){\r\n  \r\n  if(sessionStorage.getItem(\"rol\") == 4){\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction cambiarBtn(){\r\n  const btn_login = document.querySelector(\"#login\");\r\n  btn_login.classList.toggle(\"log-out\");\r\n  const btn_logout = document.querySelector(\"#logout\")\r\n  btn_logout.classList.toggle(\"login\");\r\n}"]}