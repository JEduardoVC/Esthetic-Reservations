{"version":3,"sources":["branch.js"],"names":["map","async","mostrarBranch","resultado","fetch","method","sucursales","json","login","getCookie","forEach","sucursal","location","branchName","email","name","lastName","sucursal_mostrar","document","querySelector","contenido","createElement","className","titulo","info","id","h1","textContent","appendChild","innerHTML","div_btn","form","action","btn","type","mapa","google","maps","Map","center","lat","lng","zoom","Marker","position","title","userId","readCookie","token","header","Headers","append","headers","redirect","usuario","nombreUsuario","classList","remove","add","cambiarBtn","addEventListener","console","log","e","error","decodeURIComponent","cookie","replace","RegExp","opciones","a_log_out","href"],"mappings":"AAAA,IAAIA,IAKJC,eAAeC,gBACX,IACI,MAAMC,QAAkBC,MAAM,kBAAkB,CAACC,OAAQ,QACnDC,QAAmBH,EAAUI,OAC7BC,EAAQC,YAwDd,GAvDAH,EAAoB,QAAEI,QAAQC,IAC1B,IAAIC,SAAEA,EAAQC,WAAEA,GAAgBF,GAC5BG,MAAEA,EAAKC,KAAEA,EAAIC,SAAEA,GAAaL,EAAgB,MAChD,MAAMM,EAAmBC,SAASC,cAAc,aAC1CC,EAAYF,SAASG,cAAc,OACzCD,EAAUE,UAAY,qBACtB,MAAMC,EAASL,SAASG,cAAc,OACtCE,EAAOD,UAAY,SACnB,MAAME,EAAON,SAASG,cAAc,OACpCG,EAAKC,GAAK,OACVD,EAAKF,UAAY,OAGjB,MAAMI,EAAKR,SAASG,cAAc,MAClCK,EAAGC,YAAcd,EACjBU,EAAOK,YAAYF,GACnBN,EAAUQ,YAAYL,GAEtBC,EAAKK,UACL,sDACuCd,KAAQC,iDACzBF,qDACIF,6BAE1B,MAAMkB,EAAUZ,SAASG,cAAc,OACvCS,EAAQL,GAAK,cACbK,EAAQR,UAAY,0BACpB,MAAMS,EAAOb,SAASG,cAAc,QACpCU,EAAKC,OAAS,cACdD,EAAK1B,OAAS,MACd,MAAM4B,EAAMf,SAASG,cAAc,UACnCY,EAAIX,UAAY,iBAChBW,EAAIN,YAAc,cAClBM,EAAIC,KAAO,SAEXH,EAAKH,YAAYK,GACjBH,EAAQF,YAAYG,GACpBP,EAAKI,YAAYE,GACjBV,EAAUQ,YAAYJ,GAGtB,MAAMW,EAAOjB,SAASG,cAAc,OACpCc,EAAKb,UAAY,OACjBtB,IAAM,IAAIoC,OAAOC,KAAKC,IAAIH,EAAM,CAC5BI,OAAQ,CAACC,IAAK,kBAAmBC,KAAM,oBACvCC,KAAM,KAEG,IAAIN,OAAOC,KAAKM,OAAO,CAChCC,SAAU,CAACJ,IAAK,kBAAmBC,KAAM,oBACzCzC,IAAKA,IACT6C,MAAOhC,IAEPO,EAAUQ,YAAYO,GACtBlB,EAAiBW,YAAYR,KAE9BZ,EAAM,CACP,MAAMsC,EAASC,WAAW,UACpBC,EAAQD,WAAW,SACnBE,EAAS,IAAIC,QACnBD,EAAOE,OAAO,gBAAiB,UAAUH,GACzC,MAAMf,EAAMf,SAASC,cAAc,gBAC7BhB,QAAkBC,MAAM,aAAa0C,EAAS,CAACzC,OAAQ,MAAO+C,QAASH,EAAQI,SAAU,WACzFC,QAAgBnD,EAAUI,QAC1BQ,KAAEA,EAAIC,SAAEA,GAAasC,EACrBC,EAAgBrC,SAASC,cAAc,kBAC7Cc,EAAIuB,UAAUC,OAAO,yBACrBxB,EAAIuB,UAAUE,IAAI,sBAClBH,EAAc5B,YAAc,GAAGZ,KAAQC,IACzB2C,aACRC,iBAAiB,SAAS,WAC9BC,QAAQC,IAAI,mCAIpB,MAAMC,GACFF,QAAQG,MAAMD,IAItB,SAAShB,WAAWhC,GAClB,OAAOkD,mBAAmB/C,SAASgD,OAAOC,QAAQ,IAAIC,OAAO,mBAAqBrD,EAAKoD,QAAQ,cAAe,QAAU,+BAAgC,QAAU,KAIpK,SAAS1D,YAEP,OAAU,GADEsC,WAAW,OAQzB,SAASY,aACP,MAAMU,EAAWnD,SAASC,cAAc,UACtBD,SAASC,cAAc,cAC/BqC,UAAUE,IAAI,WAExB,MAAMY,EAAYpD,SAASG,cAAc,KAQzC,OAPAiD,EAAUC,KAAO,IACjBD,EAAU7C,GAAK,oBACf6C,EAAUzC,UACV,0DAGAwC,EAASzC,YAAY0C,GACdA,EAnHTpD,SAAS0C,iBAAiB,oBAAoB,WAC1C1D","file":"branch.js","sourcesContent":["var map;\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    mostrarBranch();\r\n});\r\n\r\nasync function mostrarBranch(){\r\n    try{\r\n        const resultado = await fetch('/api/branch/all',{method: 'GET'});\r\n        const sucursales = await resultado.json();\r\n        const login = getCookie();\r\n        sucursales[\"content\"].forEach(sucursal => {\r\n            let { location, branchName  } = sucursal;\r\n            let { email, name, lastName } = sucursal[\"owner\"];\r\n            const sucursal_mostrar = document.querySelector(\"#sucursal\");\r\n            const contenido = document.createElement(\"div\");\r\n            contenido.className = \"sucursal-contenido\";\r\n            const titulo = document.createElement(\"div\");\r\n            titulo.className = \"nombre\";\r\n            const info = document.createElement(\"div\");\r\n            info.id = \"info\";\r\n            info.className = \"info\";\r\n\r\n            // Titulo\r\n            const h1 = document.createElement(\"h1\");\r\n            h1.textContent = branchName;\r\n            titulo.appendChild(h1);\r\n            contenido.appendChild(titulo);\r\n            \r\n            info.innerHTML = \r\n            `\r\n                <p>Nombre de la encargada: <span>${name} ${lastName}</span></p>\r\n                <p>Email: <span>${email}</span></p>\r\n                <p>Direccion: <span>${location}</span></p>\r\n            `;\r\n            const div_btn = document.createElement(\"div\");\r\n            div_btn.id = \"seleccionar\";\r\n            div_btn.className = \"seleccionar-no-sucursal\";\r\n            const form = document.createElement(\"form\");\r\n            form.action = \"/app/client\";\r\n            form.method = \"GET\";\r\n            const btn = document.createElement(\"button\");\r\n            btn.className = \"btn-secundario\";\r\n            btn.textContent = \"Seleccionar\";\r\n            btn.type = \"button\";\r\n\r\n            form.appendChild(btn);\r\n            div_btn.appendChild(form);\r\n            info.appendChild(div_btn);\r\n            contenido.appendChild(info);\r\n            \r\n            // Mapa\r\n            const mapa = document.createElement(\"div\");\r\n            mapa.className = \"mapa\";\r\n            map = new google.maps.Map(mapa, {\r\n                center: {lat: 21.14197073516805, lng: -100.31784830972968},\r\n                zoom: 15\r\n              });\r\n            var marker = new google.maps.Marker({\r\n                position: {lat: 21.14197073516805, lng: -100.31784830972968},\r\n                map: map,\r\n            title: branchName\r\n              });\r\n            contenido.appendChild(mapa);\r\n            sucursal_mostrar.appendChild(contenido);\r\n        });\r\n        if(login){\r\n          const userId = readCookie(\"userId\");\r\n          const token = readCookie(\"token\");\r\n          const header = new Headers();\r\n          header.append(\"Authorization\", `Bearer ${token}`);\r\n          const btn = document.querySelector(\"#seleccionar\");\r\n          const resultado = await fetch(`/api/user/${userId}`,{method: 'GET', headers: header, redirect: \"follow\"});\r\n          const usuario = await resultado.json();\r\n          const { name, lastName } = usuario;\r\n          const nombreUsuario = document.querySelector(\"#nombreUsuario\");\r\n          btn.classList.remove(\"seleccion-no-sucursal\");\r\n          btn.classList.add(\"seleccion-sucursal\")\r\n          nombreUsuario.textContent = `${name} ${lastName}`;\r\n          const btn_a = cambiarBtn();\r\n          btn_a.addEventListener(\"click\", function(){\r\n            console.log(\"Se clickeo el cerrar sesion\");\r\n          });\r\n        }\r\n    }\r\n    catch(e){\r\n        console.error(e);\r\n    }\r\n}\r\n\r\nfunction readCookie(name) {\r\n  return decodeURIComponent(document.cookie.replace(new RegExp(\"(?:(?:^|.*;)\\\\s*\" + name.replace(/[\\-\\.\\+\\*]/g, \"\\\\$&\") + \"\\\\s*\\\\=\\\\s*([^;]*).*$)|^.*$\"), \"$1\")) || null;\r\n}\r\n\r\n\r\nfunction getCookie(){\r\n  const rol = readCookie(\"rol\");\r\n  if(rol == 4){\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction cambiarBtn(){\r\n  const opciones = document.querySelector(\"#login\");\r\n  const img_login = document.querySelector(\"#btn-login\");\r\n  img_login.classList.add(\"log-out\");\r\n\r\n  const a_log_out = document.createElement(\"a\");\r\n  a_log_out.href = \"/\";\r\n  a_log_out.id = \"btn-cerrar-sesion\"\r\n  a_log_out.innerHTML = \r\n  `\r\n    <img class=\"login-img\" src=\"/img/salir.webp\">\r\n  `;\r\n  opciones.appendChild(a_log_out);\r\n  return a_log_out;\r\n}"]}