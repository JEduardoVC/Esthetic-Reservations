const carrito={userId:"",branchId:"",cantidad_productos:"",total_venta:"",productos:[]};let contador=0,page=1;const userId=sessionStorage.getItem("userId"),branchId=sessionStorage.getItem("branchId"),myHeaders=new Headers;async function showInfoClient(){const e=await fetch("/api/user/"+userId,{method:"GET",headers:myHeaders,redirect:"follow"}),t=await e.json(),n=document.querySelector("#nombre-usuario"),{name:o,lastName:a}=t;n.textContent=`${o} ${a}`}async function showInfoBranch(){const e=await fetch("/api/branch/"+branchId,{method:"GET",headers:myHeaders,redirect:"follow"}),t=await e.json(),{branchName:n}=t;document.querySelector("#nombre-branch").textContent=""+n}async function showInventory(){const e=await fetch("/api/owner/inventario/branch/"+branchId,{method:"GET",headers:myHeaders,redirect:"follow"}),t=await e.json();if(0==t.content){const e=document.createElement("div"),t=document.createElement("P");t.textContent="No hay inventario en esta sucursal",t.className="sin-contenido",e.appendChild(t)}else{const e=document.querySelector("#products"),n=document.createElement("div");n.classList.add("show-inventario"),t.content.forEach(e=>{const{id:t,imagen:o,inventory_name:a,price:c,store:r}=e,s=document.createElement("div");s.className="producto",s.innerHTML=`\n                <p class="img-producto">${o}</p>\n                <p class="titulo">Producto: ${a}</p>\n                <p>Precio: <span>$${c}</span></p>\n                <p>Cantidad: <span>${r}</span></p>\n            `,n.appendChild(s),s.addEventListener("click",(function(){if(s.classList.contains("producto-seleccionado"))s.classList.remove("producto-seleccionado"),removeProduct(t);else{s.classList.add("producto-seleccionado");addProduct({id:parseInt(t),name:a,precio:c})}}))}),e.appendChild(n)}}function removeProduct(e){const{productos:t}=carrito;carrito.productos=t.filter(t=>t.id!==e)}function addProduct(e){const{productos:t}=carrito;carrito.productos=[...t,e]}function nextPage(){const e=document.querySelector("#siguiente");null!=e&&e.addEventListener("click",()=>{page++,pagerButtons()})}function previousPage(){const e=document.querySelector("#anterior");null!=e&&e.addEventListener("click",()=>{page--,pagerButtons()})}function pagerButtons(){const e=document.querySelector("#siguiente"),t=document.querySelector("#anterior");1===page?(t.classList.add("ocultar"),e.classList.remove("ocultar")):2===page?(selectQuantity(),e.classList.remove("ocultar"),t.classList.remove("ocultar")):(e.classList.add("ocultar"),t.classList.remove("ocultar"),mostrarResumen()),mostrarSeccion()}function mostrarSeccion(){const e=document.querySelector(".mostrar-seccion");e&&e.classList.remove("mostrar-seccion");document.querySelector("#paso-"+page).classList.add("mostrar-seccion")}function selectQuantity(){const e=document.querySelector("#num_products");for(;e.firstChild;)e.removeChild(e.firstChild);let t=1;carrito.productos.forEach(n=>{const{name:o}=n,a=document.createElement("div");a.classList.add("list-product");const c=document.createElement("p");c.textContent=o;const r=document.createElement("input");r.type="number",r.id="quantity_product_"+t,a.appendChild(c),a.appendChild(r),e.appendChild(a),t++})}async function mostrarResumen(){carrito.userId=userId,carrito.branchId=branchId;const{productos:e}=carrito,t=document.querySelector("#resumen");for(;t.firstChild;)t.removeChild(t.firstChild);if(0==carrito.productos.length){const e=document.createElement("P");return e.textContent="Falta seleccionar algun producto",e.classList.add("invalidar-carrito"),void t.appendChild(e)}const n=document.createElement("H1");n.textContent="Resumen del Carrito";const o=document.createElement("DIV");o.classList.add("resumen-Productos");let a=0,c=0,r=1;e.forEach(async e=>{const{id:t}=e,n=await fetch("/api/owner/inventario/"+t,{method:"GET",headers:myHeaders,redirect:"follow"}),s=await n.json(),{inventory_name:d,price:i}=s,l=document.createElement("DIV");l.classList.add("contenedor-producto");const u=document.createElement("P");u.textContent=d;const m=document.createElement("P");m.textContent="$"+i,m.classList.add("precio"),l.appendChild(u),l.appendChild(m);const p=document.createElement("div");p.classList.add("contenedor-precio");const h=document.querySelector("#quantity_product_"+r),C=document.createElement("p");C.textContent="Cantidad seleccionada: "+h.value,c+=parseInt(h.value);const f=document.createElement("p");f.textContent="Subtotal: "+i*h.value,a+=i*h.value,carrito.total_venta=i*h.value,p.appendChild(C),p.appendChild(f),o.appendChild(l),o.appendChild(p),r++}),t.appendChild(n),t.appendChild(o);const s=document.createElement("P");s.classList.add("total"),setTimeout(()=>{s.innerHTML="<span>Total a Pagar:  </span> $"+a,carrito.cantidad_productos=c},50),t.appendChild(s);const d=document.createElement("button");d.classList.add("btn-principal"),d.classList.add("btn-reservar"),d.textContent="Realizar compra",d.onclick=makeAPurcharse,t.appendChild(d)}async function makeAPurcharse(){console.log(carrito)}myHeaders.append("Authorization","Bearer "+sessionStorage.getItem("token")),document.addEventListener("DOMContentLoaded",(function(){showInfoClient(),showInfoBranch(),showInventory(),mostrarSeccion(),nextPage(),previousPage(),pagerButtons()}));
//# sourceMappingURL=client_products.js.map
