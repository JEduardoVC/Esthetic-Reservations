{"version":3,"sources":["client_services.js"],"names":["cita","userId","branchId","fecha","hora","servicios","contador","page","sessionStorage","getItem","myHeaders","Headers","async","showServices","resultadoServicios","fetch","method","headers","redirect","json","div_servicios","document","querySelector","sinServicios","createElement","textContent","className","appendChild","forEach","servicio","id","service_name","duration","price","div_servicio","innerHTML","addEventListener","classList","contains","remove","removeService","add","addService","parseInt","name","precio","e","console","error","filter","servicioObj","nextPage","pagerButtons","previousPage","previosPage","mostrarResumen","mostrarSeccion","seccionAnterior","backDateDisabled","inputFecha","fechaAhora","Date","fechaDeshabilitar","getFullYear","getMonth","getDate","min","horaCita","resultadoBranch","branch","inputHora","target","value","split","scheduleOpen","scheduleClose","setTimeout","fechaCita","fechaInput","dia","getUTCDay","includes","preventDefault","mostrarAlerta","resumenDiv","firstChild","removeChild","Object","values","noServicios","headingCita","resultadoUsuario","client","lastName","serviciosCita","headingServicios","cantidad","service","contenedorServicio","textoServicio","precioServicio","cantidadPagar","btnReserve","onclick","makeAnAppointment","servicesId","push","append","resultadoCita","body","JSON","stringify","id_branch","appointment_date","appointment_time","id_service","id_client","respuesta","data","QRious","element","size","backgroundAlpha","foreground","level","src","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","file","File","type","input","accept","files","item","QRCode","enviarMultimediaCorreo","showInfoClient","showInfoBranch"],"mappings":"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","file":"client_services.js","sourcesContent":["const cita = {\r\n    userId: '',\r\n    branchId: '',\r\n    fecha: '',\r\n    hora: '',\r\n    servicios: []\r\n}\r\n\r\nlet contador = 0;\r\n\r\nlet page = 1;\r\n\r\nconst userId = sessionStorage.getItem(\"userId\");\r\nconst branchId = sessionStorage.getItem(\"branchId\");\r\nconst myHeaders = new Headers();\r\nmyHeaders.append(\"Authorization\", `Bearer ${sessionStorage.getItem(\"token\")}` );\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    // Show info for nav\r\n    showInfoClient();\r\n    showInfoBranch();\r\n    \r\n    // Show services\r\n    showServices();\r\n\r\n    // Show seccion \r\n    mostrarSeccion()\r\n    \r\n    // Buttons\r\n    nextPage();\r\n    previousPage();\r\n\r\n    // Paginator\r\n    pagerButtons();\r\n\r\n    // Date and hour\r\n    backDateDisabled();\r\n    horaCita();\r\n    fechaCita();\r\n\r\n    //Show summary of the cita\r\n    //mostrarResumen();\r\n});\r\n\r\nasync function showServices(){\r\n    try{\r\n        const resultadoServicios = await fetch(`/api/owner/servicios/branch/${branchId}`,{method: 'GET', headers: myHeaders, redirect: 'follow'});\r\n        const servicios = await resultadoServicios.json();\r\n        if(servicios[\"content\"] == 0){\r\n            const div_servicios = document.querySelector(\"#servicios\");\r\n            const sinServicios = document.createElement(\"P\");\r\n            sinServicios.textContent = \"No hay servicios registrados\"\r\n            sinServicios.className = \"sin-contenido\";\r\n            div_servicios.appendChild(sinServicios)\r\n        }\r\n        servicios[\"content\"].forEach(servicio => {\r\n            const { id, service_name, duration, price } = servicio;\r\n            const div_servicios = document.querySelector(\"#servicios\");\r\n            const div_servicio = document.createElement(\"div\");\r\n            div_servicio.className = \"servicio\";\r\n            div_servicio.innerHTML =\r\n            `\r\n                <p class=\"titulo\">${service_name}</p>\r\n                <p>Duracion aproximada: ${duration} min</p>\r\n                <p>Precio: <span>$${price}</span></p>\r\n            `;\r\n            div_servicios.appendChild(div_servicio);\r\n            div_servicio.addEventListener(\"click\",function(){\r\n                if(div_servicio.classList.contains(\"servicio-seleccionado\")){\r\n                    div_servicio.classList.remove(\"servicio-seleccionado\");\r\n                    removeService(id);\r\n                } else {\r\n                    div_servicio.classList.add(\"servicio-seleccionado\");\r\n                    const servicioObj = {\r\n                        id: parseInt(id),\r\n                        name: service_name,\r\n                        precio: price\r\n                    }\r\n                    addService(servicioObj);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    catch(e){\r\n        console.error(e);\r\n    }\r\n}\r\n\r\nfunction removeService(id) {\r\n    const { servicios } = cita;\r\n    cita.servicios = servicios.filter(servicio => servicio.id !== id);\r\n}\r\n\r\nfunction addService(servicioObj) {\r\n    const { servicios } = cita;\r\n    cita.servicios = [...servicios, servicioObj];\r\n}\r\n\r\nfunction nextPage() {\r\n    const nextPage = document.querySelector(`#siguiente`);\r\n    if(nextPage != null){\r\n        nextPage.addEventListener(\"click\", () =>{\r\n            page++;\r\n            pagerButtons();\r\n        })\r\n    }\r\n}\r\n\r\nfunction previousPage() {\r\n    const previousPage = document.querySelector(`#anterior`);\r\n    if(previousPage != null){\r\n        previousPage.addEventListener(\"click\", () =>{\r\n            page--;\r\n            pagerButtons();\r\n        })\r\n    }\r\n}\r\n\r\nfunction pagerButtons(){\r\n    const nextPage = document.querySelector(\"#siguiente\");\r\n    const previosPage = document.querySelector(\"#anterior\");\r\n    if (page === 1) {\r\n        previosPage.classList.add('ocultar');\r\n    }else if (page === 2) {\r\n        previosPage.classList.remove('ocultar');\r\n        nextPage.classList.remove('ocultar');\r\n    } else {\r\n        nextPage.classList.add('ocultar');\r\n        previosPage.classList.remove('ocultar');\r\n        mostrarResumen(); // Estamos en la página 3, carga el resumen de la cita\r\n    }\r\n    mostrarSeccion(); // Cambia la sección que se muestra por la de la página\r\n}\r\n\r\nfunction mostrarSeccion() {\r\n    // Eliminar mostrar-seccion de la sección anterior\r\n    const seccionAnterior = document.querySelector('.mostrar-seccion');\r\n    if (seccionAnterior) {\r\n        seccionAnterior.classList.remove('mostrar-seccion');\r\n    }\r\n    const seccionActual = document.querySelector(`#paso-${page}`);\r\n    seccionActual.classList.add('mostrar-seccion');\r\n}\r\n\r\nfunction backDateDisabled() {\r\n    const inputFecha = document.querySelector('#fecha');\r\n\r\n    const fechaAhora = new Date();\r\n    const year = fechaAhora.getFullYear();\r\n    const mes = fechaAhora.getMonth() + 1;\r\n    const dia = fechaAhora.getDate() + 1;\r\n    const fechaDeshabilitar = `${year}-${mes}-${dia}`;\r\n\r\n    inputFecha.min = fechaDeshabilitar;\r\n}\r\n\r\nasync function horaCita() {\r\n    const resultadoBranch = await fetch(`/api/branch/${branchId}`,{method: 'GET', headers: myHeaders, redirect: 'follow'});\r\n    const branch = await resultadoBranch.json();\r\n    const inputHora = document.querySelector('#hora');\r\n    inputHora.addEventListener('input', e => {\r\n        const horaCita = e.target.value;\r\n        const hora = horaCita.split(':');\r\n        const { scheduleOpen, scheduleClose } = branch;\r\n        if(hora[0] >= scheduleOpen.split(\":\")[0] && hora[1] >= scheduleOpen.split(\":\")[1]) {\r\n            cita.hora = horaCita;\r\n        } else {\r\n            console.error(\"Es muy temprano\");\r\n            setTimeout(() => {\r\n                inputHora.value = '';\r\n            }, 3000);\r\n        }\r\n    });\r\n}\r\n\r\nfunction fechaCita() {\r\n    const fechaInput = document.querySelector('#fecha');\r\n    fechaInput.addEventListener('input', e => {\r\n        const dia = new Date(e.target.value).getUTCDay();\r\n        if ([0, 6].includes(dia)) {\r\n            e.preventDefault();\r\n            fechaInput.value = '';\r\n            mostrarAlerta('Fines de Semana no son permitidos', 'error');\r\n        } else {\r\n            cita.fecha = fechaInput.value;\r\n        }\r\n    })\r\n}\r\n\r\nasync function mostrarResumen() {\r\n    cita.userId = userId;\r\n    cita.branchId = branchId;\r\n\r\n\r\n    // Destructuring\r\n    const { servicios, fecha, hora } = cita;\r\n\r\n    // Seleccionar el resumen\r\n    const resumenDiv = document.querySelector('#resumen');\r\n    \r\n    // Limpia el HTML previo\r\n    while (resumenDiv.firstChild) {\r\n        resumenDiv.removeChild(resumenDiv.firstChild);\r\n    }\r\n    // validación de objeto\r\n    if (Object.values(cita).includes('')) {\r\n        const noServicios = document.createElement('P');\r\n        noServicios.textContent = 'Faltan datos de Servicios, hora, fecha';\r\n        noServicios.classList.add('invalidar-cita');\r\n\r\n        // agregar a resumen Div\r\n        resumenDiv.appendChild(noServicios);\r\n        /*Swal.fire({\r\n          icon: 'error',\r\n          title: 'Oops...',\r\n          text: 'Faltan datos de Servicios, hora, fecha!',\r\n        })*/\r\n        return;\r\n    }\r\n\r\n    const headingCita = document.createElement('H1');\r\n    headingCita.textContent = 'Resumen de cita';\r\n\r\n    const resultadoUsuario = await fetch(`/api/user/${userId}`,{method: 'GET', headers: myHeaders, redirect: 'follow'});\r\n    const client = await resultadoUsuario.json();\r\n    const { name, lastName } = client;\r\n\r\n    // Mostrar el resumen\r\n    const fechaCita = document.createElement('P');\r\n    fechaCita.innerHTML = `<span>Fecha:</span> ${fecha}`;\r\n\r\n    const horaCita = document.createElement('P');\r\n    horaCita.innerHTML = `<span>Hora:</span> ${hora}`;\r\n\r\n    const serviciosCita = document.createElement('DIV');\r\n    serviciosCita.classList.add('resumen-servicios');\r\n\r\n    const headingServicios = document.createElement('H3');\r\n    headingServicios.textContent = 'Resumen de Servicios';\r\n\r\n    serviciosCita.appendChild(headingServicios);\r\n\r\n    let cantidad = 0;\r\n\r\n    // Iterar sobre el arreglo de servicios\r\n    servicios.forEach(async servicio => {\r\n        const {id} = servicio;\r\n        const resultadoServicios = await fetch(`/api/owner/servicios/${id}`,{method: 'GET', headers: myHeaders, redirect: 'follow'});\r\n        const service = await resultadoServicios.json();\r\n        const {service_name, price} = service;\r\n        const contenedorServicio = document.createElement('DIV');\r\n        contenedorServicio.classList.add('contenedor-servicio');\r\n\r\n        const textoServicio = document.createElement('P');\r\n        textoServicio.textContent = service_name;\r\n\r\n        const precioServicio = document.createElement('P');\r\n        precioServicio.textContent = \"$\" + price;\r\n        precioServicio.classList.add('precio');\r\n        cantidad += price;\r\n\r\n        // Colocar texto y precio en el div\r\n        contenedorServicio.appendChild(textoServicio);\r\n        contenedorServicio.appendChild(precioServicio);\r\n\r\n        serviciosCita.appendChild(contenedorServicio);\r\n    });\r\n    resumenDiv.appendChild(headingCita);\r\n    resumenDiv.appendChild(fechaCita);\r\n    resumenDiv.appendChild(horaCita);\r\n\r\n    resumenDiv.appendChild(serviciosCita);\r\n\r\n    const cantidadPagar = document.createElement('P');\r\n    cantidadPagar.classList.add('total');\r\n    setTimeout(() => {\r\n        cantidadPagar.innerHTML = `<span>Total a Pagar:  </span> $${cantidad}`;\r\n    }, 50);\r\n    resumenDiv.appendChild(cantidadPagar);\r\n\r\n    // Button for reservation\r\n    const btnReserve = document.createElement(\"button\");\r\n    btnReserve.classList.add(\"btn-principal\");\r\n    btnReserve.classList.add(\"btn-reservar\");\r\n    btnReserve.textContent = \"Reservar cita\";\r\n    btnReserve.onclick = makeAnAppointment;\r\n\r\n    resumenDiv.appendChild(btnReserve);\r\n}\r\n\r\nasync function makeAnAppointment(){\r\n    const { branchId, fecha, hora, servicios, userId} = cita;\r\n    const servicesId = [];\r\n    servicios.forEach(service => {\r\n        servicesId.push(service.id)\r\n    })\r\n    myHeaders.append(\"Content-Type\", \"application/json\");\r\n    const resultadoCita = await fetch(`/api/appointment/guardar`,{\r\n        method: 'POST',\r\n        headers: myHeaders,\r\n        body: JSON.stringify({\r\n            \"id_branch\": parseInt(branchId),\r\n            \"appointment_date\": fecha,\r\n            \"appointment_time\": `00:${hora}`,\r\n            \"id_service\": servicesId,\r\n            \"id_client\": parseInt(userId)\r\n        }),\r\n        redirect: 'follow'\r\n    });\r\n    const respuesta = await resultadoCita.json();\r\n    if(respuesta){\r\n        const {id} = respuesta;\r\n        const qr = new QRious({\r\n            element: document.createElement(\"img\"),\r\n            value: \"{id_cita: 1}\", \r\n            size: 200,\r\n            backgroundAlpha: 0,\r\n            foreground: \"#000000\",\r\n            level: \"H\",\r\n          });\r\n          const src = qr.element.src;\r\n          const data = src.split(\",\")[1];\r\n          bstr = atob(data),\r\n          n = bstr.length, \r\n          u8arr = new Uint8Array(n);\r\n          while(n--){\r\n              u8arr[n] = bstr.charCodeAt(n);\r\n          }\r\n          const file = new File(u8arr, \"qr.png\", {\r\n            type: \"image/png\"\r\n        });\r\n          const input = document.createElement(\"input\");\r\n          input.type = \"file\";\r\n          input.accept = \"image/*\";\r\n          input.files.item = file\r\n          const QRCode = input.files;\r\n          enviarMultimediaCorreo(userId, QRCode, branchId, id)\r\n    }\r\n}"]}