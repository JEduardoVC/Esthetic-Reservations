{"version":3,"sources":["client_products.js"],"names":["carrito","userId","branchId","cantidad_productos","total_venta","productos","contador","page","sessionStorage","getItem","myHeaders","Headers","async","showInfoClient","resultadoUsuario","fetch","method","headers","redirect","client","json","nameUser","document","querySelector","name","lastName","textContent","showInfoBranch","resultadoBranch","branch","branchName","showInventory","resultInventory","inventory","div_productos","createElement","noInventory","className","appendChild","inventario","showProducts","classList","add","forEach","product","id","imagen","inventory_name","price","store","div_product","innerHTML","addEventListener","contains","remove","removeProduct","addProduct","parseInt","precio","filter","producto","productoObj","nextPage","pagerButtons","previousPage","previosPage","selectQuantity","mostrarResumen","mostrarSeccion","seccionAnterior","select","firstChild","removeChild","cont","layout","text","input","type","resumenDiv","length","noProductos","headingCarrito","productosCarrito","cantidad","resultProductSelected","productSelected","contenedorproducto","textoproducto","precioproducto","contenedorPrecios","quantity","value","subtotal","cantidadPagar","setTimeout","btnReserve","onclick","makeAPurcharse","console","log","append"],"mappings":"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","file":"client_products.js","sourcesContent":["const carrito = {\r\n    userId:'',\r\n    branchId:'',\r\n    cantidad_productos:'',\r\n    total_venta: '',\r\n    productos: []\r\n}\r\n\r\nlet contador = 0;\r\nlet page = 1;\r\n\r\nconst userId = sessionStorage.getItem(\"userId\");\r\nconst branchId = sessionStorage.getItem(\"branchId\");\r\nconst myHeaders = new Headers();\r\nmyHeaders.append(\"Authorization\", `Bearer ${sessionStorage.getItem(\"token\")}` );\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    // Show info for nav\r\n    showInfoClient();\r\n    showInfoBranch();\r\n    \r\n    // Show Products\r\n    showInventory();\r\n\r\n    // Show seccion \r\n    mostrarSeccion()\r\n    \r\n    // Buttons\r\n    nextPage();\r\n    previousPage();\r\n\r\n    // Paginator\r\n    pagerButtons();\r\n});\r\nasync function showInfoClient(){\r\n    const resultadoUsuario = await fetch(`/api/user/${userId}`,{method: 'GET', headers: myHeaders, redirect: 'follow'});\r\n    const client = await resultadoUsuario.json();\r\n    const nameUser = document.querySelector(\"#nombre-usuario\");\r\n    const { name, lastName } = client;\r\n    nameUser.textContent = `${name} ${lastName}`;\r\n}\r\n\r\nasync function showInfoBranch(){\r\n    const resultadoBranch = await fetch(`/api/branch/${branchId}`,{method: 'GET', headers: myHeaders, redirect: 'follow'});\r\n    const branch = await resultadoBranch.json();\r\n    const { branchName } = branch;\r\n    const nameBranch = document.querySelector(\"#nombre-branch\");\r\n    nameBranch.textContent = `${branchName}`;\r\n}\r\n\r\nasync function showInventory(){\r\n    const resultInventory = await fetch(`/api/owner/inventario/branch/${branchId}`,{method: 'GET', headers: myHeaders, redirect: 'follow'});\r\n    const inventory = await resultInventory.json();\r\n    if(inventory[\"content\"] == 0){\r\n        const div_productos = document.createElement(\"div\");\r\n        const noInventory = document.createElement(\"P\");\r\n        noInventory.textContent = \"No hay inventario en esta sucursal\"\r\n        noInventory.className = \"sin-contenido\";\r\n        div_productos.appendChild(noInventory)\r\n    } else {\r\n        const inventario = document.querySelector(\"#products\");\r\n        const showProducts = document.createElement(\"div\");\r\n        showProducts.classList.add(\"show-inventario\");\r\n        inventory[\"content\"].forEach(product => {\r\n            const {id, imagen, inventory_name, price, store} = product;\r\n            const div_product = document.createElement(\"div\");\r\n            div_product.className = \"producto\";\r\n            div_product.innerHTML = `\r\n                <p class=\"img-producto\">${imagen}</p>\r\n                <p class=\"titulo\">Producto: ${inventory_name}</p>\r\n                <p>Precio: <span>$${price}</span></p>\r\n                <p>Cantidad: <span>${store}</span></p>\r\n            `;\r\n            showProducts.appendChild(div_product);\r\n            div_product.addEventListener(\"click\",function(){\r\n                if(div_product.classList.contains(\"producto-seleccionado\")){\r\n                    div_product.classList.remove(\"producto-seleccionado\");\r\n                    removeProduct(id);\r\n                } else {\r\n                    div_product.classList.add(\"producto-seleccionado\");\r\n                    const servicioObj = {\r\n                        id: parseInt(id),\r\n                        name: inventory_name,\r\n                        precio: price\r\n                    }\r\n                    addProduct(servicioObj);\r\n                }\r\n            });\r\n        })\r\n        inventario.appendChild(showProducts);\r\n    }\r\n}\r\n\r\nfunction removeProduct(id) {\r\n    const { productos } = carrito;\r\n    carrito.productos = productos.filter(producto => producto.id !== id);\r\n}\r\n\r\nfunction addProduct(productoObj) {\r\n    const { productos } = carrito;\r\n    carrito.productos = [...productos, productoObj];\r\n}\r\n\r\nfunction nextPage() {\r\n    const nextPage = document.querySelector(`#siguiente`);\r\n    if(nextPage != null){\r\n        nextPage.addEventListener(\"click\", () =>{\r\n            page++;\r\n            pagerButtons();\r\n        })\r\n    }\r\n}\r\n\r\nfunction previousPage() {\r\n    const previousPage = document.querySelector(`#anterior`);\r\n    if(previousPage != null){\r\n        previousPage.addEventListener(\"click\", () =>{\r\n            page--;\r\n            pagerButtons();\r\n        })\r\n    }\r\n}\r\n\r\nfunction pagerButtons(){\r\n    const nextPage = document.querySelector(\"#siguiente\");\r\n    const previosPage = document.querySelector(\"#anterior\");\r\n    if (page === 1) {\r\n        previosPage.classList.add('ocultar');\r\n        nextPage.classList.remove('ocultar');\r\n    } else if(page === 2){\r\n        selectQuantity();\r\n        nextPage.classList.remove('ocultar');\r\n        previosPage.classList.remove('ocultar');\r\n    } else {\r\n        nextPage.classList.add('ocultar');\r\n        previosPage.classList.remove('ocultar');\r\n        mostrarResumen();\r\n    }\r\n    mostrarSeccion(); // Cambia la sección que se muestra por la de la página\r\n}\r\n\r\nfunction mostrarSeccion() {\r\n    // Eliminar mostrar-seccion de la sección anterior\r\n    const seccionAnterior = document.querySelector('.mostrar-seccion');\r\n    if (seccionAnterior) {\r\n        seccionAnterior.classList.remove('mostrar-seccion');\r\n    }\r\n    const seccionActual = document.querySelector(`#paso-${page}`);\r\n    seccionActual.classList.add('mostrar-seccion');\r\n}\r\n\r\nfunction selectQuantity(){\r\n    const select = document.querySelector(\"#num_products\");\r\n    // Clean the display for the new array\r\n    while (select.firstChild) {\r\n        select.removeChild(select.firstChild);\r\n    }\r\n    let cont = 1;\r\n    carrito[\"productos\"].forEach(product =>{\r\n        const {name} = product;\r\n        const layout = document.createElement(\"div\");\r\n        layout.classList.add(\"list-product\");\r\n        const text = document.createElement(\"p\");\r\n        text.textContent = name;\r\n        const input = document.createElement(\"input\");\r\n        input.type = \"number\";\r\n        input.id = \"quantity_product_\" + cont;\r\n        layout.appendChild(text);\r\n        layout.appendChild(input);\r\n        select.appendChild(layout);\r\n        cont++;\r\n    });\r\n}\r\n\r\nasync function mostrarResumen() {\r\n    carrito.userId = userId;\r\n    carrito.branchId = branchId;\r\n    // Destructuring\r\n    const {productos} = carrito;\r\n\r\n    // Seleccionar el resumen\r\n    const resumenDiv = document.querySelector('#resumen');\r\n    \r\n    // Limpia el HTML previo\r\n    while (resumenDiv.firstChild) {\r\n        resumenDiv.removeChild(resumenDiv.firstChild);\r\n    }\r\n    // validación de objeto\r\n    if (carrito[\"productos\"].length == 0) {\r\n        const noProductos = document.createElement('P');\r\n        noProductos.textContent = 'Falta seleccionar algun producto';\r\n        noProductos.classList.add('invalidar-carrito');\r\n\r\n        // agregar a resumen Div\r\n        resumenDiv.appendChild(noProductos);\r\n        /*Swal.fire({\r\n          icon: 'error',\r\n          title: 'Oops...',\r\n          text: 'Faltan datos de Productos, hora, fecha!',\r\n        })*/\r\n        return;\r\n    }\r\n\r\n    const headingCarrito = document.createElement('H1');\r\n    headingCarrito.textContent = 'Resumen del Carrito';\r\n\r\n    // Mostrar el resumen\r\n    const productosCarrito = document.createElement('DIV');\r\n    productosCarrito.classList.add('resumen-Productos');\r\n\r\n    let cantidad = 0;\r\n    let cantidad_productos = 0;\r\n    let cont = 1;\r\n    // Iterar sobre el arreglo de Productos\r\n    productos.forEach(async producto => {\r\n        const {id} = producto;\r\n\r\n        const resultProductSelected = await fetch(`/api/owner/inventario/${id}`,{method: 'GET', headers: myHeaders, redirect: 'follow'});\r\n        const productSelected = await resultProductSelected.json();\r\n\r\n        const {inventory_name, price} = productSelected;\r\n    \r\n        const contenedorproducto = document.createElement('DIV');\r\n        contenedorproducto.classList.add('contenedor-producto');\r\n\r\n        const textoproducto = document.createElement('P');\r\n        textoproducto.textContent = inventory_name;\r\n        \r\n        const precioproducto = document.createElement('P');\r\n        precioproducto.textContent = \"$\" + price;\r\n        precioproducto.classList.add('precio');\r\n        \r\n        // Colocar texto y precio en el div\r\n        contenedorproducto.appendChild(textoproducto);\r\n        contenedorproducto.appendChild(precioproducto);\r\n\r\n        const contenedorPrecios = document.createElement(\"div\");\r\n        contenedorPrecios.classList.add(\"contenedor-precio\");\r\n\r\n        const input = document.querySelector(\"#quantity_product_\" + cont);\r\n        \r\n        const quantity = document.createElement(\"p\");\r\n        quantity.textContent = \"Cantidad seleccionada: \" + input.value;\r\n        cantidad_productos += parseInt(input.value);\r\n        \r\n        const subtotal = document.createElement(\"p\");\r\n        subtotal.textContent =\"Subtotal: \" + price*input.value;\r\n        cantidad += price*input.value;\r\n        carrito.total_venta = price*input.value;\r\n\r\n        contenedorPrecios.appendChild(quantity);\r\n        contenedorPrecios.appendChild(subtotal);\r\n        \r\n        productosCarrito.appendChild(contenedorproducto);\r\n        productosCarrito.appendChild(contenedorPrecios);\r\n        cont++;\r\n    });\r\n    \r\n    resumenDiv.appendChild(headingCarrito);\r\n    resumenDiv.appendChild(productosCarrito);\r\n    \r\n    const cantidadPagar = document.createElement('P');\r\n    cantidadPagar.classList.add('total');\r\n    setTimeout(() => {\r\n        cantidadPagar.innerHTML = `<span>Total a Pagar:  </span> $${cantidad}`;\r\n        carrito.cantidad_productos = cantidad_productos;\r\n    }, 50);\r\n    resumenDiv.appendChild(cantidadPagar);\r\n    \r\n    // Button for reservation\r\n    const btnReserve = document.createElement(\"button\");\r\n    btnReserve.classList.add(\"btn-principal\");\r\n    btnReserve.classList.add(\"btn-reservar\");\r\n    btnReserve.textContent = \"Realizar compra\";\r\n    btnReserve.onclick = makeAPurcharse;\r\n\r\n    resumenDiv.appendChild(btnReserve);\r\n}\r\n\r\nasync function makeAPurcharse(){\r\n    console.log(carrito);\r\n}\r\n"]}